ext.brokerFile = file('broker.properties')

 task loadbroker {
   Properties brokers = readBrokers()

   for(String key : brokers.stringPropertyNames()) {

       String[] brokerelems = brokers.getProperty(key).split(':')

       //tmpHM.each{ key, value ->
       //   doSomethingWithKeyAndValue()
       //}

       //for (final String name: properties.stringPropertyNames())
       //map.put(name, properties.getProperty(name));

       for(String s : brokerelems) { println(s)}
       println()
   }
}

  Properties readBrokers() {

   logger.quiet 'Reading the brokers file.'

   if (!ext.brokerFile.exists()) {
       throw new GradleException(
       "Required broker file does not exist: $brokerFile.canonicalPath")
   }
   Properties brokerProps = new Properties()
   brokerFile.withInputStream { stream -> brokerProps.load(stream) }
    return brokerProps
 }
