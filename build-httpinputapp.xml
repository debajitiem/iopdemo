<?xml version="1.0" encoding="UTF-8"?>
<project name="IIB Application Build" default="deploy">

	<import file="masterbuild.xml"/>

	<!-- Start of Global Properties -->

	<dirname property="build.dir" file="${ant.file}" />
	<property file="${build.dir}${file.separator}build-${iib.app}.properties" />
	<property name="iib.bar" value="${iib.app}" />
	<property name="iib.workspace" location="${basedir}" />

	<property name="iib.barfile.param" value="${barfile.dir}${file.separator}${iib.bar}_${time.stamp}_${iib.bar.version}.bar" />
	<property name="bar.logfile" value="${iib.bar}_${time.stamp}_${iib.bar.version}.log" />

	<property name="override.file"
		location="${build.dir}${file.separator}override-${iib.app}.properties" />

	<!-- Parameters for the various mqsi commands -->

	<property name="mqsi.createbar.parameters" value="-data ${iib.workspace} -b ${iib.barfile.param} ${iib.mqsicreatebar.params}" />
	<property name="mqsi.applybaroverride.parameters" value="-b ${iib.barfile.param} -p ${override.file} -r" />
	<property name="mqsi.deploy.parameters" value="-n ${iib.brokerfile} -e ${iib.svr} -a ${iib.barfile.param} -m" />

	<!-- End of Global Properties -->

		<target name="compile" depends="cleanup,init.os" description="Creates a new BAR file using the mqsicreatebar command." unless="${deploy.only}">
			<echo message="COMPILE target starting ...${line.separator}" />
			<echo message="Command line: ${mqsi.createbar} ${mqsi.createbar.parameters}${line.separator}" />
			<exec executable="${mqsi.createbar}"><!--logError="true" output="${bar.logfile}" append="true" -->
				<arg line="${mqsi.createbar.parameters}" />
			</exec>
		</target>

</project>
